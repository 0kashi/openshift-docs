// Module included in the following assemblies:
//
// * logging/efk-logging-elasticsearch.adoc

[id='efk-logging-elasticsearch-persistent-storage-persistent_{context}']
= Configuring Elasticscearch storage to use an existing NFS persistent volume

You can deploy NFS using a predefined NFS volume.

For more information, see _Sharing an NFS mount across two persistent volume claims_ to leverage shared storage for use by two separate containers.

.Procedure

. Prepare persistent volumes
+
----
$ oc get pv
$ oc label volume $volumename 'preparefor'="logging1"
----

. Edit or create the Cluster Logging Custom Resource (CR):
+
[source,yaml]
----
spec:
  managementState: Managed
  nodeSpec:
    image: brewregistry.stage.redhat.io/openshift/ose-logging-elasticsearch5:v4.0
    resources: {}
  nodes:
  - nodeCount: 1
    nodeSpec:
      resources: {}
    roles:
    - client
    - data
    - master
    storage:
      VolumeClaimTemplate:
        apiVersion: v1
        metadata:
          name: myclaim
       spec:
         accessModes:
           - ReadWriteOnce
        selector:
           matchLabels:
           preparefor: "logging1"
----

. Check that the PVC was created:
+
----
$ oc get pvc -n openshift-logging
----

. Check that the PVC is mounted to Elasticsearch:
+
----
$ oc get deployment --select component=elasticsearch
----
