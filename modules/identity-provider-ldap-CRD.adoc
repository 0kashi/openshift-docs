// Module included in the following assemblies:
//
// * authentication/identity_providers/configuring-ldap-identity-provider.adoc

[id='identity-provider-ldap-CRD-{context}']
= Sample LDAP CRD

The following Custom Resource Definition (CRD) shows the parameters and acceptable values for an
LDAP identity provider.

.LDAP CRD

[source,yaml]
----
apiVersion: config.openshift.io/v1
kind: OAuth
metadata:
  name: cluster
spec:
  identityProviders:
  - name: ldapidp <1>
    challenge: false <2>
    login: true <3>
    mappingMethod: claim <4>
    type: LDAP
    ldap:
      attributes:
        id: <5>
        - dn
        email: <6>
        - mail
        name: <7>
        - cn
        preferredUsername: <8>
        - uid
      bindDN: "" <9>
      bindPassword: "" <10>
      ca: /path/to/ca.file <11>
      insecure: false <12>
      url: "ldap://ldap.example.com/ou=users,dc=acme,dc=com?uid" <13>
----
<1> This provider name is prefixed to the returned user ID to form an identity
name.
<2> When `true`, unauthenticated token requests from non-web clients, like the
CLI, are sent a `WWW-Authenticate` challenge header for this provider.
<3> When `true`, unauthenticated token requests from web clients, like the web
console, are redirected to a login page backed by this provider.
<4> Controls how mappings are established between this provider's identities and user objects.
<5> List of attributes to use as the identity. First non-empty attribute is
used. At least one attribute is required. If none of the listed attribute have a
value, authentication fails.
<6> List of attributes to use as the email address. First non-empty attribute is
used.
<7> List of attributes to use as the display name. First non-empty attribute is
used.
<8> List of attributes to use as the preferred user name when provisioning a
user for this identity. First non-empty attribute is used.
<9> Optional DN to use to bind during the search phase.
<10> Optional reference to an {product-title} Secret containing the bind
password.
<11> Certificate bundle to use to validate server certificates for the
configured URL. If empty, system trusted roots are used. Only applies if
`insecure: false`.
<12> When `true`, no TLS connection is made to the server. When `false`,
`ldaps://` URLs connect using TLS, and `ldap://` URLs are upgraded to TLS.
This should be set to `false` when `ldaps://` URLs are in use, as these 
URLs always attempt to connect using TLS.
<13> An RFC 2255 URL which specifies the LDAP host and search parameters to use.

[NOTE]
====
To whitelist users for an LDAP integration, use the `lookup` mapping method.
Before a login from LDAP would be allowed, a cluster administrator must create
an identity and user object for each LDAP user.
====
