// Module included in the following assemblies:
//
// * logging/efk-logging-curator.adoc

[id='efk-logging-curator-configuration_{context}']
= Creating the Curator configuration

The `openshift_logging` Ansible role provides a ConfigMap from which Curator
reads its configuration. You may edit or replace this ConfigMap to reconfigure
Curator. Currently the `logging-curator` ConfigMap is used to configure both
your ops and non-ops Curator instances. Any `.operations` configurations are
in the same location as your application logs configurations.

. To create the Curator configuration, edit the configuration in the deployed
ConfigMap:
+
----
$ oc edit configmap/logging-curator
----
+
Or, manually create the jobs from a cronjob:
+
----
oc create job --from=cronjob/logging-curator <job_name>
----
+
* For scripted deployments, copy the configuration file that was created by the
installer and create your new {product-title} custom configuration:
+
----
$ oc extract configmap/logging-curator --keys=curator5.yaml,config.yaml --to=/my/config
  edit /my/config/curator5.yaml
  edit /my/config/config.yaml
$ oc delete configmap logging-curator ; sleep 1
$ oc create configmap logging-curator \
    --from-file=curator5.yaml=/my/config/curator5.yaml \
    --from-file=config.yaml=/my/config/config.yaml \
    ; sleep 1
----
+
* Alternatively, if you are using the *actions file*:
+
----
$ oc extract configmap/logging-curator --keys=curator5.yaml,actions.yaml --to=/my/config
  edit /my/config/curator5.yaml
  edit /my/config/actions.yaml
$ oc delete configmap logging-curator ; sleep 1
$ oc create configmap logging-curator \
    --from-file=curator5.yaml=/my/config/curator5.yaml \
    --from-file=actions.yaml=/my/config/actions.yaml \
    ; sleep 1
----

The next scheduled job uses this configuration.

You can use the following commands to control the cronjob:

----
# suspend cronjob
oc patch cronjob logging-curator -p '{"spec":{"suspend":true}}'

# resume cronjob
oc patch cronjob logging-curator -p '{"spec":{"suspend":false}}

# change cronjob schedule
oc patch cronjob logging-curator -p '{"spec":{"schedule":"0 0 * * *"}}' <1>
----
<1> The `schedule` option accepts schedules in link:https://en.wikipedia.org/wiki/Cron[cron format].