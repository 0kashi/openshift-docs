// Module included in the following assemblies:
//
// * installing-byoh/installing-existing-hosts.adoc

[id="installation-required-ports_{context}"]
= Required ports

The following ports are required by {product-title} and must be open for your
cluster to function.

.Node to Node
[cols='2,1,8']
|===
| *4789*
|UDP
|Required for SDN communication between pods on separate hosts.
|===

.Nodes to Master
[cols='2,1,8']
|===
| *53* or *8053*
|TCP/UDP
|Required for DNS resolution of cluster services (SkyDNS).
ifdef::openshift-origin[]
Installations prior to 1.2 or environments upgraded to 1.2 use port 53.
endif::[]
ifdef::openshift-enterprise[]
Installations prior to 3.2 or environments upgraded to 3.2 use port 53.
endif::[]
New installations will use 8053 by default so that *dnsmasq* might be configured.

| *4789*
|UDP
|Required for SDN communication between pods on separate hosts.

| *443* or *8443*
|TCP
|Required for node hosts to communicate to the master API, for the node hosts to
post back status, to receive tasks, and so on.
|===

.Master to Node
[cols='2,1,8']
|===
| *4789*
|UDP
|Required for SDN communication between pods on separate hosts.

| *10250*
|TCP
|The master proxies to node hosts via the Kubelet for `oc` commands.

| *10010*
|TCP
|If using CRI-O, open this port to allow `oc exec` and `oc rsh` operations.
|===

.Master to Master
[cols='2,1,8']
|===
| *53* or *8053*
|TCP/UDP
|Required for DNS resolution of cluster services (SkyDNS).
ifdef::openshift-origin[]
Installations prior to 1.2 or environments upgraded to 1.2 use port 53.
endif::[]
ifdef::openshift-enterprise[]
Installations prior to 3.2 or environments upgraded to 3.2 use port 53.
endif::[]
New installations will use 8053 by default so that *dnsmasq* might be configured.

| *2049*
|TCP/UDP
|Required when provisioning an NFS host as part of the installer.

| *2379*
|TCP
|Used for standalone etcd (clustered) to accept changes in state.

| *2380*
|TCP
|etcd requires this port be open between masters for leader election and peering
connections when using standalone etcd (clustered).

| *4789*
|UDP
|Required for SDN communication between pods on separate hosts.

|===

.External to Load Balancer
[cols='2,1,8']
|===
| *9000*
|TCP
|If you choose the `native` HA method, optional to allow access to the HAProxy statistics page.

|===


.External to Master
[cols='2,1,8']
|===
| *443* or *8443*
|TCP
|Required for node hosts to communicate to the master API, for node hosts to
post back status, to receive tasks, and so on.

|*8444*
|TCP
|Port that the controller service listens on. Required to be open for the `/metrics` and `/healthz` endpoints.
|===

.IaaS Deployments
[cols='2,1,8']
|===
| *22*
|TCP
| Required for SSH by the installer or system administrator.

| *53* or *8053*
|TCP/UDP
|Required for DNS resolution of cluster services (SkyDNS).
ifdef::openshift-origin[]
Installations prior to 1.2 or environments upgraded to 1.2 use port 53.
endif::[]
ifdef::openshift-enterprise[]
Installations prior to 3.2 or environments upgraded to 3.2 use port 53.
endif::[]
New installations will use 8053 by default so that *dnsmasq* might be configured.
Only required to be internally open on master hosts.

| *80* or *443*
|TCP
| For HTTP/HTTPS use for the router. Required to be externally open on node hosts, especially on nodes running the router.

| *1936*
|TCP
| (*Optional*) Required to be open when running the template router to access
statistics. Can be open externally or internally to connections depending on if
you want the statistics to be expressed publicly. Can require extra
configuration to open. See the Notes section below for more information.

| *2379* and *2380*
|TCP
| For standalone etcd use. Only required to be internally open on the master host.
*2379* is for server-client connections. *2380* is for server-server
connections, and is only required if you have clustered etcd.

| *4789*
|UDP
| For VxLAN use (OpenShift SDN). Required only internally on node hosts.

| *8443*
|TCP
| For use by the {product-title} web console, shared with the API server.

| *10250*
|TCP
| For use by the Kubelet. Required to be externally open on nodes.
|===

*Notes*

* In the above examples, port *4789* is used for User Datagram Protocol (UDP).
* When deployments are using the SDN, the pod network is accessed via a service 
proxy, unless it is accessing the registry from the same node the registry is 
deployed on.
* {product-title} internal DNS cannot be received over SDN. For non-cloud 
deployments, this will default to the IP address associated with the default
route on the master host. For cloud deployments, it will default to the IP
address associated with the first internal interface as defined by the cloud
metadata.
* The master host uses port *10250* to reach the nodes and does not go over SDN.
It depends on the target host of the deployment and uses the computed value of
`openshift_public_hostname`.
* Port *1936* can still be inaccessible due to your iptables rules. Use the following to configure iptables to open port *1936*:
+
----
# iptables -A OS_FIREWALL_ALLOW -p tcp -m state --state NEW -m tcp \
    --dport 1936 -j ACCEPT
----

.Aggregated Logging
[cols='2,1,8']
|===
| *9200*
|TCP
|For Elasticsearch API use. Required to be internally open on any infrastructure
nodes so Kibana is able to retrieve logs for display. It can be externally
opened for direct access to Elasticsearch by means of a route. The route can be
created using `oc expose`.

| *9300*
|TCP
|For Elasticsearch inter-cluster use. Required to be internally open on any
infrastructure node so the members of the Elasticsearch cluster might communicate
with each other.
|===
