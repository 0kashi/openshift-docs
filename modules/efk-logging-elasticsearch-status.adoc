// Module included in the following assemblies:
//
// * logging/efk-logging-elasticsearch.adoc

[id="efk-logging-elasticsearch-status-{context}"]
= Viewing Elasticsearch status

You can view the status of your Elasticsearch cluster.

.Prerequisites

* Cluster logging and Elasticsearch must be installed.

.Procedure

Run the following command to view the Elasticsearch status:

----
$ oc get Elasticsearch elasticsearch -n openshift-logging -o yaml

status:
  clusterHealth: green <1>
  conditions: <2>
      .....
  nodes:  <2>
      .....
  pods: <3>
      .....
  shardAllocationEnabled: "True" <4>
----
<1> The status of the Elasticsearch cluster, `green`, `red`, `yellow`.
<2> Conditions
<3> The Elsticsearch nodes in the cluster, with `upgradeStatus`.  
<4> The Elasticsearch client, data, and master pods in the cluster, listed under 'failed`, `notReady` or `ready` state.

oc get deployment --selector component=elasticsearch -n openshift-logging -o name

https://github.com/openshift/elasticsearch-operator/pull/92

----
  conditions:
  - lastTransitionTime: 2019-03-06T23:33:00Z
    message: Invalid master nodes count. Please ensure there are no more than 3 total
      nodes with master roles
    reason: Invalid Settings
    status: "True"
    type: InvalidMasters
  - lastTransitionTime: 2019-03-06T23:28:37Z
    status: "False"
    type: InvalidData
  - lastTransitionTime: 2019-03-06T23:28:38Z
    status: "False"
    type: InvalidRedundancy
  - lastTransitionTime: 2019-03-06T23:30:35Z
    message: Config Map is different
    reason: ConfigChange
    status: "True"
    type: UpdatingSettings
  - lastTransitionTime: 2019-03-06T23:28:52Z
    status: "False"
    type: ScalingUp
  - lastTransitionTime: 2019-03-06T23:28:52Z
    status: "False"
    type: ScalingDown
  - lastTransitionTime: 2019-03-06T23:28:52Z
    status: "False"
    type: Restarting
----

Example conditions

----
  nodes:
  - conditions:
    - lastTransitionTime: 2019-03-15T15:57:22Z
      message: Disk storage usage for node is 27.5gb (36.74%). Shards will be not
        be allocated on this node.
      reason: Disk Watermark Low
      status: "True"
      type: NodeStorage
    deploymentName: example-elasticsearch-clientdatamaster-0-1
    upgradeStatus: {}
----

----
  nodes:
  - conditions:
    - lastTransitionTime: 2019-03-15T16:04:45Z
      message: Disk storage usage for node is 27.5gb (36.74%). Shards will be relocated
        from this node.
      reason: Disk Watermark High
      status: "True"
      type: NodeStorage
    deploymentName: example-elasticsearch-clientdatamaster-0-1
    upgradeStatus: {}
----

