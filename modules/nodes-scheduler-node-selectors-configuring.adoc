// Module included in the following assemblies:
//
// * nodes/nodes-scheduler-node-selector.adoc

[id='nodes-scheduler-node-selectors-configuring_{context}']
= Configuring the Pod Node Constraints admission controller to use node selectors in {product-title}

You can configure the Pod Node Constraints admission controller to ensure that pods are only placed onto nodes with specific labels.

. Ensure you have the desired labels
ifdef::openshift-enterprise,openshift-origin[]
labels on your nodes. 
endif::openshift-enterprise,openshift-origin[]
ifdef::openshift-dedicated[]
labels on your nodes (request changes by opening a support case on the
https://access.redhat.com/support/[Red Hat Customer Portal]).
endif::openshift-dedicated[]
and node selector set up in your environment.
+
For example, make sure that your pod configuration features the `nodeSelector`
value indicating the desired label:
+
----
apiVersion: v1
kind: Pod
spec:
  nodeSelector:
    <key>: <value>
...
----

. Modify the master configuration file, *_/etc/origin/master/master-config.yaml_*, to add `nodeSelectorLabelBlacklist` to the `admissionConfig` section with
the labels that are assigned to the node hosts you want to deny pod placement:
+
----
...
admissionConfig:
  pluginConfig:
    PodNodeConstraints:
      configuration:
        apiversion: v1
        kind: PodNodeConstraintsConfig
        nodeSelectorLabelBlacklist:
          - kubernetes.io/hostname
          - <label>
...
----

. Restart {product-title} for the changes to take effect.
+
----
# master-restart controllers
----

[NOTE] 
====
If you are using node selectors and node affinity in the same pod configuration, note the following:

* If you configure both `nodeSelector` and `nodeAffinity`, both conditions must be satisfied for the pod to be scheduled onto a candidate node.

* If you specify multiple `nodeSelectorTerms` associated with `nodeAffinity` types, then the pod can be scheduled onto a node if one of the `nodeSelectorTerms` is satisfied.

* If you specify multiple `matchExpressions` associated with `nodeSelectorTerms`, then the pod can be scheduled onto a node only if all `matchExpressions` are satisfied.
====

