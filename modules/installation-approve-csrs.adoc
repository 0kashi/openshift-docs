// Module included in the following assemblies:
//
// * installing/installing_aws_user_infra/installing-aws-user-infra.adoc
// * installing/installing_bare_metal/installing-bare-metal.adoc
// * installing/installing_vsphere/installing-vsphere.adoc
// * machine_management/adding-rhel-compute.adoc
// * machine_management/more-rhel-compute.adoc

[id="installation-approve-csrs_{context}"]
= Approving the CSRs for your machines

When you add machines to a cluster, you must approve the pending certificate
signing requests (CSRs) for the machines that you added.

.Prerequisites

* You added machines to your cluster.

.Procedure

. Confirm that the cluster recognizes the machines:
+
----
$ oc get nodes

NAME      STATUS    ROLES   AGE  VERSION
master-0  NotReady  master  50s  v1.13.4+b626c2fe1
master-1  NotReady  master  63s  v1.13.4+b626c2fe1
master-2  NotReady  master  64s  v1.13.4+b626c2fe1
worker-0  NotReady  worker  76s  v1.13.4+b626c2fe1
worker-1  NotReady  worker  70s  v1.13.4+b626c2fe1
worker-2  NotReady  worker  69s  v1.13.4+b626c2fe1
----
+
The output lists all of the machines that you created.

. Review the pending certificate signing requests (CSRs) and ensure that the
requests are for the machines that you added to the cluster:
+
----
$ oc get csr

NAME        AGE     REQUESTOR                                                                   CONDITION
csr-8b2br   15m     system:serviceaccount:openshift-machine-config-operator:node-bootstrapper   Approved,Issued
csr-8vnps   15m     system:serviceaccount:openshift-machine-config-operator:node-bootstrapper   Approved,Issued
csr-b96j4   25s     system:node:ip-10-0-52-215.us-east-2.compute.internal                       Approved,Issued
csr-bfd72   5m26s   system:node:ip-10-0-50-126.us-east-2.compute.internal                       Pending
csr-c57lv   5m26s   system:node:ip-10-0-95-157.us-east-2.compute.internal                       Pending
----

. Approve the CSRs for your cluster machines.
** To approve them individually, run the following command for each valid
CSR:
+
----
$ oc adm certificate approve <csr_name> <1>
----
<1> `<csr_name>` is the name of a CSR from the list of current CSRs.

** If all the CSRs are valid, approve them all by running the following
command:
+
----
$ oc get csr -ojson | jq -r '.items[] | select(.status == {} ) | .metadata.name' | xargs oc adm certificate approve
----