// Module included in the following assemblies:
//
// * authentication/identity_providers/configuring-gitlab-identity-provider.adoc

[id='identity-provider-gitlab-CR-{context}']
= Sample GitLab CR

The following Custom Resource (CR) shows the parameters and acceptable values for a
GitLab identity provider.

.GitLab CR

[source,yaml]
----
apiVersion: config.openshift.io/v1
kind: OAuth
metadata:
  name: cluster
spec:
  identityProviders:
  - name: gitlabidp <1>
    challenge: false <2>
    login: true <3>
    mappingMethod: claim <4>
    type: GitLab
    gitlab:
      clientID: {...} <5>
      clientSecret: <6>
        name: gitlab-secret
      url: https://gitlab.com <7>
      ca: <8>
        name: ca-config-map
----
<1> This provider name is prefixed to the GitLab numeric user ID to form an
identity name. It is also used to build the callback URL.
<2> When `true`, unauthenticated token requests from non-web clients, like
the CLI, are sent a `WWW-Authenticate` challenge header for this provider.
This uses the link:http://doc.gitlab.com/ce/api/oauth2.html#resource-owner-password-credentials[Resource Owner Password Credentials]
grant flow to obtain an access token from GitLab.
<3> When `true`, unauthenticated token requests from web clients, like the web
console, are redirected to GitLab to log in.
<4> Controls how mappings are established between this provider's identities and user objects.
<5> The client ID of a
link:https://docs.gitlab.com/ce/api/oauth2.html[registered GitLab OAuth application].
The application must be configured with a callback URL of
`<master>/oauth2callback/<identityProviderName>`.
<6> Reference to an {product-title} Secret containing the client secret
issued by GitLab.
<7> The host URL of a GitLab provider. This could either be `\https://gitlab.com/`
or any other self hosted instance of GitLab.
<8> Optional: Reference to a {product-title} ConfigMap containing the 
PEM-encoded certificate authority bundle to use in validating server 
certificates for the configured URL.
