// Module included in the following assemblies:
//
// * authentication/identity_providers/configuring-gitlab-identity-provider.adoc

[id='identity-provider-gitlab-CRD-{context}']
= Sample GitLab CRD

The following Custom Resource Definition (CRD) shows the parameters and acceptable values for a
GitLab identity provider.

.GitLab CRD

[source,yaml]
----
oauthConfig:
  ...
  identityProviders:
  - name: gitlab <1>
    challenge: true <2>
    login: true <3>
    mappingMethod: claim <4>
    provider:
      apiVersion: v1
      kind: GitLabIdentityProvider
      legacy: <5>
      url: ... <6>
      clientID: ... <7>
      clientSecret: ... <8>
      ca: ... <9>
----
<1> This provider name is prefixed to the GitLab numeric user ID to form an
identity name. It is also used to build the callback URL.
<2> When `true`, unauthenticated token requests from non-web clients (like
the CLI) are sent a `WWW-Authenticate` challenge header for this provider.
This uses the link:http://doc.gitlab.com/ce/api/oauth2.html#resource-owner-password-credentials[Resource Owner Password Credentials]
grant flow to obtain an access token from GitLab.
<3> When `true`, unauthenticated token requests from web clients (like the web
console) are redirected to GitLab to log in.
<4> Controls how mappings are established between this provider's identities and user objects.
<5> Determines whether to use OAuth or OIDC as the authentication provider. Set
to `true` to use OAuth and `false` to use OIDC. You must use GitLab.com or
GitLab version 11.1 or later to use OIDC. If you do not provide a value, OAuth
is used to connect to your GitLab instance, and OIDC is used to connect to
GitLab.com.
<6> The host URL of a GitLab provider. This could either be `\https://gitlab.com/`
or any other self hosted instance of GitLab.
<7> The client ID of a
link:https://docs.gitlab.com/ce/api/oauth2.html[registered GitLab OAuth application].
The application must be configured with a callback URL of
`<master>/oauth2callback/<identityProviderName>`.
<8> The client secret issued by GitLab. This value may also be provided in an
environment variable, external file, or encrypted file.
<9> CA is an optional trusted certificate authority bundle to use when making
requests to the GitLab instance. If empty, the default system roots are used.
