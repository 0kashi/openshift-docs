// Module included in the following assemblies:
//
// * authentication/configuring-internal-oauth.adoc

[id="oauth-configuring-internal-oauth-{context}"]
= Configuring options for the internal OAuth server

You can configure default options for the internal OAuth server's session,
session secrets, token duration, and grant options.

.Procedure

. Create the OAuth session secret file:
+
[source,yaml]
----
apiVersion: v1
kind: SessionSecrets
secrets: <1>
- authentication: "..." <2>
  encryption: "..." <3>
- authentication: "..."
  encryption: "..."
...
----
<1> List of secrets used to authenticate and encrypt cookie sessions. Specify
at least one secret. Each secret must set an authentication and
encryption secret.
<2> Signing secret, used to authenticate sessions using HMAC. Recommended to use
a secret with 32 or 64 bytes.
<3> Encrypting secret, used to encrypt sessions. Must be 16, 24, or 32
characters long, to select AES-128, AES-192, or AES-256.


. Set the session options:
+
[source,yaml]
----
oauthConfig:
  ...
  sessionConfig:
    sessionMaxAgeSeconds: 300 <1>
    sessionName: ssn <2>
    sessionSecretsFile: "..." <3>
----
<1> Controls the maximum age of a session; sessions auto-expire once a token
request is complete. If the `auto-grant` grant option is not enabled for the cluster, sessions
must last as long as the user is expected to take to approve or reject a client
authorization request.
<2> Name of the cookie used to store the session.
<3> File name containing serialized `SessionSecrets` object. If empty, a
random signing and encryption secret is generated at each server start.

. Set the token duration options:
+
[source,yaml]
----
oauthConfig:
  ...
  tokenConfig:
    accessTokenMaxAgeSeconds: 86400 <1>
    authorizeTokenMaxAgeSeconds: 300 <2>
----
<1> Set `accessTokenMaxAgeSeconds` to control the lifetime of access tokens.
The default lifetime is 24 hours, or 86400 seconds.
<2> Set `authorizeTokenMaxAgeSeconds` to control the lifetime of authorize
codes. The default lifetime is five minutes, or 300 seconds.

. Set the grant options:
+
[source,yaml]
----
oauthConfig:
  ...
  grantConfig:
    method: auto <1>
----
<1> Specify the grant option: `auto` to automatically approve the grant and
retry the request, `prompt` to prompt the user to approve or deny the grant, or
`deny` to deny the grant and return a failure error to the client.
